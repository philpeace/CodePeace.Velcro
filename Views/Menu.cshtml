@{    
    // Model is Model.Menu from the layout (Layout.Menu)
    var tag = Tag(Model, "ul");
    tag.Attributes["class"] = "";
    tag.AddCssClass("nav");

    if (Model.Classes.Count > 0)
    {
        foreach (var c in Model.Classes)
        {
            tag.AddCssClass(c);
        }
    }

    var items = (IList<dynamic>)Enumerable.Cast<dynamic>(Model.Items);

    if (items.Any()) {
        items[0].Classes.Add("first");
        items[items.Count - 1].Classes.Add("last");
    }    
}
@tag.StartElement
    @DisplayChildren(Model)
@tag.EndElement
